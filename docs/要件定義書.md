# 要件定義書

## 1. 目的
UVC Camera (USB Video Class) を利用したAndroidアプリで、プレビュー表示、録画、録画済みファイルの再生/削除を提供する。

## 2. スコープ
- 対象: UVCCameraDemoアプリ
- 対象機能: UVCカメラのプレビュー/録画/再生/削除
- 対象外: クラウド連携、動画編集、ライブ配信

## 3. 前提/制約
- Android端末がUSB OTGに対応していること
- 対応OS: Android 7.0 (API 24) 以上
- UVC準拠のUSBカメラを使用すること
- 対応解像度/フレームレート: 640x480@30fpsを必須対応、1280x720@30fpsと1920x1080@30fpsに対応（カメラ/端末が対応している場合）
- ネットワーク接続は不要(オフライン動作)

## 4. 用語
- UVC Camera: USB Video Classに準拠したUSBカメラ
- 録画ファイル: 本アプリで保存された動画ファイル

## 5. 機能要件
### 5.1 カメラ接続/認識
- UVCカメラ接続時に認識し、利用許可を促す
- 未接続時は案内を表示する
- 接続解除時はプレビュー/録画を停止し、ユーザーに通知する

### 5.2 プレビュー表示
- カメラ映像を低遅延で表示する
- 画面回転時も適切な向き/アスペクト比で表示する
- プレビューの開始/停止をユーザー操作で行える

### 5.3 録画
- プレビュー中に録画開始/停止ができる
- 録画中は状態表示(タイマー/インジケータ)を行う
- 録画停止後、ファイルを保存し一覧に反映する
- 録画中のエラー(ストレージ不足、切断など)を通知する
- 録画は映像+音声を含む

### 5.4 録画ファイル一覧
- 録画済みファイルを一覧表示する
- ファイル名/日時/サイズ/再生時間を表示する

### 5.5 再生
- 録画ファイルを端末内で再生できる
- 再生/一時停止/シーク等の基本操作を提供する

### 5.6 削除
- 録画ファイルを削除できる
- 誤操作防止のため削除前に確認ダイアログを表示する
- 削除後は一覧から即時反映する

### 5.7 権限/プライバシー
- USBデバイス利用許可を取得する
- 録音権限を取得する
- 録画ファイルは端末内に保存し、外部送信は行わない

## 6. 非機能要件
### 6.1 性能
- プレビュー開始までの時間は実用的な範囲(数秒以内を目標)
- 連続録画中に大きなフレーム落ちが発生しないこと

### 6.2 信頼性
- 予期せぬ切断時もアプリがクラッシュしないこと
- 録画中断時は可能な範囲でファイルを保全する

### 6.3 互換性
- 対応OSバージョン: Android 7.0 (API 24) 以上
- 対応カメラはUVC準拠に限定する

### 6.4 使いやすさ
- 主要操作(録画/停止/再生/削除)は1タップで到達できる
- エラー時は分かりやすいメッセージを表示する

## 7. 画面要件(案)
- メイン画面: プレビュー表示、録画開始/停止ボタン、録画一覧への導線
- 一覧画面: 録画ファイルの一覧、再生/削除の操作
- 再生画面: 動画プレイヤーと基本操作

## 8. データ要件
- 保存先: アプリ専用領域 `context.getExternalFilesDir(null)/Movies/UVC`
- ファイル命名: `uvc_yyyyMMdd_HHmmss.mp4`
- ファイル形式/コーデック: MP4 (H.264 + AAC)、映像+音声

## 9. 受入条件
- UVCカメラ接続後にプレビューが表示される
- 録画開始/停止で動画が保存され、一覧に表示される
- 保存済み動画が再生できる
- 動画を削除すると一覧から消える
- 再生時に音声が確認できる

## 10. 決定事項
- 対応OS: Android 7.0 (API 24) 以上
- 対応解像度/フレームレート: 640x480@30fpsを必須対応、1280x720@30fpsと1920x1080@30fpsに対応（カメラ/端末が対応している場合）
- 録画形式: MP4 (H.264 + AAC)、映像+音声
- 保存先: `context.getExternalFilesDir(null)/Movies/UVC`
